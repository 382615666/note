# ip协议

![数据包](../img/1541667205(1).jpg)

* 协议头长度计算： 1111 = 15，这里的1位代表32bit，也就是说4字节。 最大协议头长度 = 15 * 4 = 60，一般是20（5 * 4 = 20）

![头部计算](../img/1541667548(1).jpg)

* 服务类型：3位优先权字段(现已被忽略) + 4位TOS字段 + 1位保留字段(须为0)。4位TOS字段分别表示最小延时、最大吞吐量、最高可靠性、最小费用，其中最多有一个能置为1。应用程序根据实际需要来设置 TOS值，如ssh和telnet这样的登录程序需要的是最小延时的服务，文件传输ftp需要的是最大吞吐量的服务

* 标识：在报文重组的时候有用，同一个数据报分片标识相同，不同数据报标识 + 1

* 标志： 上图中的标志其实是由两部分构成（3位标志和13位的片位移构成）。

    1. 标志位。第一位保留，第二位0不分片，第三位1后面还有分片，0最后一个分片
    2. 片位移。数据报重组，需要计算，[参考链接](https://blog.csdn.net/deramer1/article/details/73410019)

* 生存时间： TTL。每跳转一个路由 - 1。0则丢弃数据包